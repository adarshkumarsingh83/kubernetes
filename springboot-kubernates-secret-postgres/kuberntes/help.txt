
#To build code
$ mvn clean package

# To build the docker image and tag
$ docker build -f Dockerfile -t adarshkumarsingh83/springboot-jpa-postgres .

# to push the docker image to the docker hub
$ docker push adarshkumarsingh83/springboot-jpa-postgres

#NOTE CHANGE TO THE DOCKER DESKTOP IN THE DOCKER -> KUBERNATES

$ kubectl cluster-info

# to create service and other in kubernetes
$ kubectl apply -f $(pwd)/configmap.yml
$ kubectl apply -f $(pwd)/secret.yml
$ kubectl apply -f $(pwd)/postgres.yml
$ kubectl apply -f $(pwd)/springboot.yml

#to view the service and other
$ kubectl get all

#to view the secrets
$ kubectl get secrets

#to get the persistence volume
$ kubectl get persistentvolumes
$ kubectl get persistentvolumeclaims

#TO VIEW THE POD DETAILS
$ kubectl get pod

#TO VIEW THE LOGS OF THE POD
$ kubectl logs <pod-name> -f

$ kubectl describe services springboot-jpa-postgres

$ kubectl port-forward svc/springboot-jpa-postgres 9090:9090

$ curl http://localhost:9090/api/employee
$ curl http://localhost:9090/api/employee/1
$ curl http://localhost:9090/api/employee/2

# TO DELETE CONFIG MAP
$ kubectl delete configmap  postgres-db-conf  -n   default

$ kubectl delete  secret/postgres-db-credentials

#FOR DELETING DEPLOYMENT AND SERVICE
$ kubectl delete services  springboot-jpa-postgres
$ kubectl delete deployment  springboot-jpa-postgres

#FOR DELETING DEPLOYMENT AND SERVICE OF POSTGRACE
$ kubectl delete services  postgres
$ kubectl delete deployment  postgres
$ kubectl delete pvc postgres-pv-claim